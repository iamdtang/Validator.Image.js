/*! Validator.Image() - v0.2.0 - 2013-02-04
* https://github.com/skaterdav85/Validator.Image
* Copyright (c) 2013 David; Licensed  */
(function(e,t){var n=e.FileReader?!0:!1;e.Validator=e.Validator||{},Validator.Image=function(e){if(n){if(e.file&&e.file instanceof File)this.file=e.file;else{if(!e.url)throw new Error("Provide a file handle or image URL.");this.url=e.url}this.width=e.width?e.width:[0,Number.POSITIVE_INFINITY],this.height=e.height?e.height:[0,Number.POSITIVE_INFINITY],this.success=e.success?e.success:function(){},this.error=e.error?e.error:function(){},this.errorMessages=[],this.errorCount=0,this._initialize()}},Validator.Image.prototype={constructor:Validator.Image,_initialize:function(){var e;this.file?(e=this._fileReaderFactory(),e.readAsDataURL(this.file)):this.url&&this._checkImageURL()},_checkImageURL:function(){var e=document.createElement("img"),t=this;e.src=this.url,e.onload=function(){t.img=this,t._validateDimensions(this.width,this.height)}},getImage:function(){return this.img},getErrorMessages:function(e){return e?this.errorMessages[e]:this.errorMessages},_createRangeErrorMessage:function(e){this.errorMessages[e]="The "+e+" should be between "+this[e][0]+" and "+this[e][1]+" pixels."},_createErrorMessage:function(e){this.errorMessages[e]="The "+e+" does not equal "+this[e]+" pixels."},_validateDimensions:function(e,t){if(this.width instanceof Array){if(e<this.width[0]||e>this.width[1])this.errorCount++,this._createRangeErrorMessage("width")}else e!==this.width&&(this.errorCount++,this._createErrorMessage("width"));if(this.height instanceof Array){if(t<this.height[0]||t>this.height[1])this.errorCount++,this._createRangeErrorMessage("height")}else t!==this.height&&(this.errorCount++,this._createErrorMessage("height"));this.errorCount>0?this.error.call(this,this.getImage()):this.success.call(this,this.getImage())},_fileReaderFactory:function(){var e=new FileReader,t=this;return e.onload=function(e){var n=document.createElement("img");n.onload=function(){t.img=this,t._validateDimensions(this.width,this.height)},n.src=e.target.result},e.onerror=function(e){throw new Error("Error reading file")},e}}})(window);